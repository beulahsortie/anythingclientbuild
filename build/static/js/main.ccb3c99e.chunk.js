(this["webpackJsonpreact-social"]=this["webpackJsonpreact-social"]||[]).push([[0],{120:function(e,t,n){},121:function(e,t,n){},122:function(e,t,n){},123:function(e,t,n){},124:function(e,t,n){},125:function(e,t,n){},126:function(e,t,n){},127:function(e,t,n){},128:function(e,t,n){},129:function(e,t,n){},130:function(e,t,n){},131:function(e,t,n){},132:function(e,t,n){},133:function(e,t,n){},134:function(e,t,n){},168:function(e,t,n){"use strict";n.r(t);var c=n(0),s=n.n(c),a=n(27),r=n.n(a),o=n(2),i=(n(92),n(182)),l=n(183),u=n(184),j=n(185),d=n(19),p=n(12),b=n(28),O=function(e,t){switch(t.type){case"LOGIN_START":return{user:null,token:null,isFetching:!0,error:!1};case"LOGIN_SUCCESS":return{user:t.payload.user,token:t.payload.token,isFetching:!1,error:!1};case"LOGIN_FAILURE":return{user:null,token:null,isFetching:!1,error:!0};case"FOLLOW":return Object(b.a)(Object(b.a)({},e),{},{user:Object(b.a)(Object(b.a)({},e.user),{},{followings:[].concat(Object(p.a)(e.user.followings),[t.payload])})});case"UNFOLLOW":return Object(b.a)(Object(b.a)({},e),{},{user:Object(b.a)(Object(b.a)({},e.user),{},{followings:e.user.followings.filter((function(e){return e!==t.payload}))})});default:return e}},h=n(1),f={user:JSON.parse(localStorage.getItem("user"))||null,token:localStorage.getItem("token")||null,isFetching:!1,error:!1},m=Object(c.createContext)(f),x=Object(c.createContext)(),v=function(e){var t=e.children,n=Object(c.useReducer)(O,f),s=Object(o.a)(n,2),a=s[0],r=s[1],i=Object(c.useState)(null),l=Object(o.a)(i,2),u=l[0],j=l[1];return Object(c.useEffect)((function(){localStorage.setItem("user",JSON.stringify(a.user)),localStorage.setItem("token",a.token||"")}),[a.user,a.token]),Object(h.jsx)(m.Provider,{value:{user:a.user,token:a.token,isFetching:a.isFetching,error:a.error,dispatch:r},children:Object(h.jsx)(x.Provider,{value:{passobject:u,setPassobject:j},children:t})})},g=n(86),N=n(84),k=(n(96),n(4)),w=n.n(k),S=n(9),I=n(39),C=n(8),y=n.n(C),_={BASE_URL:"http://74.225.184.249/api",SOCKET_URL:"74.225.184.249"},L={width:"100%",height:"500px"},A=function(){var e=Object(c.useState)(null),t=Object(o.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)(null),r=Object(o.a)(a,2),i=r[0],l=r[1],u=Object(c.useState)([]),j=Object(o.a)(u,2),d=j[0],p=j[1],b=_.BASE_URL;Object(c.useEffect)((function(){navigator.geolocation.getCurrentPosition((function(e){var t={lat:e.coords.latitude,lng:e.coords.longitude};s(t),l(t),O(t.lat,t.lng)}))}),[]);var O=function(){var e=Object(S.a)(w.a.mark((function e(t,n){var c;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.a.get("".concat(b,"/maps/nearby-users?lat=").concat(t,"&lng=").concat(n));case 3:c=e.sent,console.log("nearby-users",c.data),p(c.data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(h.jsx)(I.b,{googleMapsApiKey:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_SocketURL_dev:"localhost",REACT_APP_API_SocketURL_prod:"74.225.184.249",REACT_APP_API_URL_dev:"http://localhost:8800/api",REACT_APP_API_URL_prod:"http://74.225.184.249/api",REACT_APP_PUBLIC_FOLDER:"http://localhost:8800/images/"}).googlemapsapikey,children:Object(h.jsxs)(I.a,{mapContainerStyle:L,center:i||n||{lat:0,lng:0},zoom:14,onClick:function(e){var t={lat:e.latLng.lat(),lng:e.latLng.lng()};l(t),O(t.lat,t.lng)},children:[i&&Object(h.jsx)(I.c,{position:i,label:"Selected"}),d.map((function(e,t){return Object(h.jsx)(I.c,{position:{lat:e.location.coordinates[1],lng:e.location.coordinates[0]},label:e.name},t)}))]})})};var R=function(e){var t=e.onClose;return Object(h.jsx)("div",{className:"modal-overlay",children:Object(h.jsxs)("div",{className:"modal-content",children:[Object(h.jsx)("button",{className:"close-button",onClick:t,children:"X"}),Object(h.jsx)("h2",{children:"Popup Content"}),Object(h.jsx)("p",{children:"This is a 70% screen modal popup."}),Object(h.jsx)(A,{})]})})};function E(){var e=Object(c.useContext)(m).user,t="http://localhost:8800/images/",n=Object(c.useState)(!1),s=Object(o.a)(n,2),a=s[0],r=s[1];return Object(h.jsxs)("div",{className:"topbarContainer",children:[Object(h.jsx)("div",{className:"topbarLeft",children:Object(h.jsx)(d.b,{to:"/",style:{textDecoration:"none"},children:Object(h.jsx)("span",{className:"logo",children:"Anything"})})}),Object(h.jsx)("div",{className:"topbarCenter",children:Object(h.jsxs)("div",{className:"searchbar",children:[Object(h.jsx)(i.a,{className:"searchIcon"}),Object(h.jsx)("input",{placeholder:"Search for friend, post or video",className:"searchInput"})]})}),Object(h.jsxs)("div",{children:[Object(h.jsx)("span",{onClick:function(){return r(!0)},children:Object(h.jsx)(l.a,{style:{color:" #fcfaf9 "}})}),a&&Object(h.jsx)(R,{onClose:function(){return r(!1)}})]}),Object(h.jsxs)("div",{className:"topbarRight",children:[Object(h.jsxs)("div",{className:"topbarLinks",children:[Object(h.jsx)("span",{className:"topbarLink"}),Object(h.jsx)(d.b,{to:"/",children:Object(h.jsx)("span",{className:"topbarLink",children:"Homepage"})})]}),Object(h.jsxs)("div",{className:"topbarIcons",children:[Object(h.jsx)(d.b,{to:"/messenger",children:Object(h.jsx)("div",{className:"topbarIconItem",children:Object(h.jsx)(u.a,{style:{color:" #fcfaf9 "}})})}),Object(h.jsxs)("div",{className:"topbarIconItem",children:[Object(h.jsx)(j.a,{}),Object(h.jsx)("span",{className:"topbarIconBadge",children:"1"})]})]}),Object(h.jsx)(d.b,{to:"/profile/".concat(e.username),children:Object(h.jsx)("img",{src:e.profilePicture?t+e.profilePicture:t+"person/noAvatar.png",alt:"",className:"topbarImg"})}),Object(h.jsx)("div",{className:"topbarIconItem",children:Object(h.jsx)("button",{onClick:function(){localStorage.removeItem("user"),localStorage.removeItem("token"),console.log("user",e._id),window.location.reload()},style:{backgroundColor:"#1877f2",border:"none",borderRadius:"5px",padding:"10px",cursor:"pointer"},children:Object(h.jsx)(g.a,{icon:N.a,style:{fontSize:"20px",color:"white",backgroundColor:"#1877f2",border:"none",padding:0,margin:0}})})})]})]})}n(120);var P=n(186);n(121);function T(){return Object(h.jsx)("div",{className:"sidebar",children:Object(h.jsxs)("div",{className:"sidebarWrapper",children:[Object(h.jsxs)("ul",{className:"sidebarList",children:[Object(h.jsxs)("li",{className:"sidebarListItem",children:[Object(h.jsx)(P.a,{className:"sidebarIcon"}),Object(h.jsx)("span",{className:"sidebarListItemText",children:"Feed"})]}),Object(h.jsxs)("li",{className:"sidebarListItem",children:[Object(h.jsx)(u.a,{className:"sidebarIcon"}),Object(h.jsx)("span",{className:"sidebarListItemText",children:"Chats"})]})]}),Object(h.jsx)("button",{className:"sidebarButton",children:"Show More"}),Object(h.jsx)("hr",{className:"sidebarHr"})]})})}n(122);var B=n(187),U=n(48),F=n(10);function D(e){var t=e.post,n=Object(c.useState)(t.likes.length),s=Object(o.a)(n,2),a=s[0],r=s[1],i=Object(c.useState)(!1),l=Object(o.a)(i,2),u=l[0],j=l[1],p=Object(c.useState)({}),b=Object(o.a)(p,2),O=b[0],f=b[1],v="http://localhost:8800/images/",g=Object(c.useContext)(m).user,N=Object(F.g)(),k=Object(c.useContext)(x).setPassobject,I=_.BASE_URL;Object(c.useEffect)((function(){j(t.likes.includes(g._id))}),[g._id,t.likes]),Object(c.useEffect)((function(){(function(){var e=Object(S.a)(w.a.mark((function e(){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get("".concat(I,"/users?userId=").concat(t.userId));case 2:n=e.sent,f(n.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t.userId]);var C=function(){var e=Object(S.a)(w.a.mark((function e(t){var n,c,s,a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("postuser..",t),e.next=4,y.a.get("".concat(I,"/conversations/find/").concat(g._id,"/").concat(t));case 4:if(n=e.sent,console.log("con..",n.data),null!==n.data){e.next=16;break}return c=g._id,s=t,e.next=11,y.a.post("".concat(I,"/conversations"),{senderId:c,receiverId:s});case 11:a=e.sent,console.log("newconv",a),k(a.data),e.next=17;break;case 16:k(n.data);case 17:N.push("/messenger"),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),console.log(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(t){return e.apply(this,arguments)}}(),L=function(){try{y.a.put("".concat(I,"/posts/")+t._id+"/like",{userId:g._id})}catch(e){}r(u?a-1:a+1),j(!u)};return Object(h.jsx)("div",{className:"post",children:Object(h.jsxs)("div",{className:"postWrapper",children:[Object(h.jsxs)("div",{className:"postTop",children:[Object(h.jsxs)("div",{className:"postTopLeft",children:[Object(h.jsx)(d.b,{to:"/profile/".concat(O.username),children:Object(h.jsx)("img",{className:"postProfileImg",src:O.profilePicture?v+O.profilePicture:v+"person/noAvatar.png",alt:""})}),Object(h.jsx)("span",{className:"postUsername",children:O.username}),Object(h.jsx)("span",{className:"postDate",children:Object(U.a)(t.createdAt)})]}),Object(h.jsx)("div",{className:"postTopRight",children:Object(h.jsx)(B.a,{})})]}),Object(h.jsxs)("div",{className:"postCenter",children:[Object(h.jsx)("span",{className:"postText",children:null===t||void 0===t?void 0:t.desc}),Object(h.jsx)("img",{className:"postImg",src:t.img.startsWith("https://")?t.img:v+t.img,alt:""})]}),Object(h.jsxs)("div",{className:"postBottom",children:[Object(h.jsxs)("div",{className:"postBottomLeft",children:[Object(h.jsx)("img",{className:"likeIcon",src:"".concat(v,"like.png"),onClick:L,alt:""}),Object(h.jsx)("img",{className:"likeIcon",src:"".concat(v,"heart.png"),onClick:L,alt:""}),Object(h.jsxs)("span",{className:"postLikeCounter",children:[a," people like it"]})]}),Object(h.jsx)("div",{className:"postBottomRight",children:Object(h.jsxs)("span",{className:"postCommentText",onClick:function(){return C(t.userId)},children:[t.comment," Message"]})})]})]})})}n(123);var W=n(188),M=n(189),q=n(190),G=n(191),H=n(192);function J(){var e=Object(c.useContext)(m).user,t="http://localhost:8800/images/",n=Object(c.useRef)(),s=Object(c.useState)(null),a=Object(o.a)(s,2),r=a[0],i=a[1],l=_.BASE_URL,u=function(){var t=Object(S.a)(w.a.mark((function t(c){var s,a,o,i;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c.preventDefault(),s={userId:e._id,desc:n.current.value},console.log("file",r),!r){t.next=23;break}return a=new FormData,o=Date.now()+r.name,a.append("name",o),a.append("file",r),console.log("newpost",s),console.log("data",a),t.prev=10,t.next=13,y.a.post("".concat(l,"/upload"),a);case 13:return i=t.sent,console.log("res1",i.data),t.next=17,i.data.url;case 17:s.img=t.sent,t.next=23;break;case 20:t.prev=20,t.t0=t.catch(10),console.log("err...",t.t0);case 23:return t.prev=23,t.next=26,y.a.post("".concat(l,"/posts"),s);case 26:window.location.reload(),t.next=31;break;case 29:t.prev=29,t.t1=t.catch(23);case 31:case"end":return t.stop()}}),t,null,[[10,20],[23,29]])})));return function(e){return t.apply(this,arguments)}}();return Object(h.jsx)("div",{className:"share",children:Object(h.jsxs)("div",{className:"shareWrapper",children:[Object(h.jsxs)("div",{className:"shareTop",children:[Object(h.jsx)("img",{className:"shareProfileImg",src:e.profilePicture?t+e.profilePicture:t+"person/noAvatar.png",alt:""}),Object(h.jsx)("input",{placeholder:"What's in your mind "+e.username+"?",className:"shareInput",ref:n})]}),Object(h.jsx)("hr",{className:"shareHr"}),r&&Object(h.jsxs)("div",{className:"shareImgContainer",children:[Object(h.jsx)("img",{className:"shareImg",src:URL.createObjectURL(r),alt:""}),Object(h.jsx)(W.a,{className:"shareCancelImg",onClick:function(){return i(null)}})]}),Object(h.jsxs)("form",{className:"shareBottom",onSubmit:u,children:[Object(h.jsxs)("div",{className:"shareOptions",children:[Object(h.jsxs)("label",{htmlFor:"file",className:"shareOption",children:[Object(h.jsx)(M.a,{htmlColor:"tomato",className:"shareIcon"}),Object(h.jsx)("span",{className:"shareOptionText",children:"Photo or Video"}),Object(h.jsx)("input",{style:{display:"none"},type:"file",id:"file",accept:".png,.jpeg,.jpg",onChange:function(e){return i(e.target.files[0])}})]}),Object(h.jsxs)("div",{className:"shareOption",children:[Object(h.jsx)(q.a,{htmlColor:"blue",className:"shareIcon"}),Object(h.jsx)("span",{className:"shareOptionText",children:"Tag"})]}),Object(h.jsxs)("div",{className:"shareOption",children:[Object(h.jsx)(G.a,{htmlColor:"green",className:"shareIcon"}),Object(h.jsx)("span",{className:"shareOptionText",children:"Location"})]}),Object(h.jsxs)("div",{className:"shareOption",children:[Object(h.jsx)(H.a,{htmlColor:"goldenrod",className:"shareIcon"}),Object(h.jsx)("span",{className:"shareOptionText",children:"Feelings"})]})]}),Object(h.jsx)("button",{className:"shareButton",type:"submit",children:"Share"})]})]})})}n(124);function K(e){var t=e.username,n=Object(c.useState)([]),s=Object(o.a)(n,2),a=s[0],r=s[1],i=Object(c.useContext)(m).user,l=_.BASE_URL,u=Object(c.useState)([]),j=Object(o.a)(u,2),d=j[0],p=j[1];Object(c.useEffect)((function(){navigator.geolocation.getCurrentPosition((function(e){var t={lat:e.coords.latitude,lng:e.coords.longitude};O(t.lat,t.lng),b(t.lat,t.lng),console.log("BASE_URL",l)}))}),[]);var b=function(){var e=Object(S.a)(w.a.mark((function e(t,n){var c,s;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c=i._id,e.next=4,y.a.post("".concat(l,"/maps/updatelocation"),{userid:c,latti:t,longi:n});case 4:s=e.sent,console.log("newconv",s),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),O=function(){var e=Object(S.a)(w.a.mark((function e(t,n){var c;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.a.get("".concat(l,"/maps/nearby-users?lat=").concat(t,"&lng=").concat(n));case 3:c=e.sent,console.log("nearby-users",c.data),p(c.data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){(function(){var e=Object(S.a)(w.a.mark((function e(){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("username",t),console.log("nearbyUserspost",d),!t){e.next=8;break}return e.next=5,y.a.get("".concat(l,"/posts/profile/")+t);case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,y.a.post("".concat(l,"/posts/timeline/")+i._id,d);case 10:e.t0=e.sent;case 11:n=e.t0,r(n.data.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)})));case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t,i._id,d]),Object(h.jsx)("div",{className:"feed",children:Object(h.jsxs)("div",{className:"feedWrapper",children:[(!t||t===i.username)&&Object(h.jsx)(J,{}),a.map((function(e){return Object(h.jsx)(D,{post:e},e._id)}))]})})}n(125),n(126);n(193),n(194);function z(e){var t=e.user,n=Object(c.useState)([]),s=Object(o.a)(n,2),a=(s[0],s[1]),r=Object(c.useContext)(m),i=r.user,l=(r.dispatch,Object(c.useState)(i.followings.includes(null===t||void 0===t?void 0:t.id))),u=Object(o.a)(l,2),j=(u[0],u[1],_.BASE_URL);Object(c.useEffect)((function(){(function(){var e=Object(S.a)(w.a.mark((function e(){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.a.get("".concat(j,"/users/friends/")+t._id);case 3:n=e.sent,a(n.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[t]);return Object(h.jsx)("div",{className:"rightbar",children:Object(h.jsx)("div",{className:"rightbarWrapper"})})}n(127);function V(){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(E,{}),Object(h.jsxs)("div",{className:"homeContainer",children:[Object(h.jsx)(T,{}),Object(h.jsx)(K,{}),Object(h.jsx)(z,{})]})]})}n(128);var X=_.BASE_URL,Q=function(){var e=Object(S.a)(w.a.mark((function e(t,n){var c;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n({type:"LOGIN_START"}),e.prev=1,e.next=4,y.a.post("".concat(X,"/auth/login"),t);case 4:c=e.sent,console.log("ressss",c.data),n({type:"LOGIN_SUCCESS",payload:c.data}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),n({type:"LOGIN_FAILURE",payload:e.t0});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}(),Y=n(195);function Z(){var e=Object(c.useRef)(),t=Object(c.useRef)(),n=Object(c.useContext)(m),s=n.isFetching,a=n.dispatch,r=Object(F.g)(),i=_.BASE_URL,l=function(){var n=Object(S.a)(w.a.mark((function n(c){return w.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c.preventDefault(),n.prev=1,n.next=4,Q({email:e.current.value,password:t.current.value},a);case 4:n.next=9;break;case 6:n.prev=6,n.t0=n.catch(1),console.log(n.t0);case 9:case"end":return n.stop()}}),n,null,[[1,6]])})));return function(e){return n.apply(this,arguments)}}(),u=Object(c.useState)(""),j=Object(o.a)(u,2),d=j[0],p=j[1],b=function(){var e=Object(S.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(i,"/emailotp/send-otp"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({otpemail:d})});case 2:alert("OTP sent");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=Object(c.useState)(""),f=Object(o.a)(O,2),x=f[0],v=f[1],g=function(){var e=Object(S.a)(w.a.mark((function e(){var t,n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(i,"/emailotp/verify-otp"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({otpemail:d,otp:x})});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,alert(n.message);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(h.jsx)("div",{className:"login",children:Object(h.jsxs)("div",{className:"loginWrapper",children:[Object(h.jsxs)("div",{className:"loginLeft",children:[Object(h.jsx)("h3",{className:"loginLogo",children:"Anything"}),Object(h.jsx)("span",{className:"loginDesc",children:"Connect and Share anything with friends and the world around you on Anything App."})]}),Object(h.jsxs)("div",{className:"loginRight",children:[Object(h.jsxs)("form",{className:"loginBox",onSubmit:l,children:[Object(h.jsx)("input",{placeholder:"Email",type:"email",required:!0,className:"loginInput",ref:e}),Object(h.jsx)("input",{placeholder:"Password",type:"password",required:!0,minLength:"6",className:"loginInput",ref:t}),Object(h.jsx)("button",{className:"loginButton",type:"submit",disabled:s,children:s?Object(h.jsx)(Y.a,{color:"white",size:"20px"}):"Log In"}),Object(h.jsx)("span",{className:"loginForgot",children:"Forgot Password?"})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("input",{type:"email",value:d,onChange:function(e){return p(e.target.value)}}),Object(h.jsx)("button",{onClick:b,children:"Send OTP"})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("input",{type:"email",value:d,onChange:function(e){return p(e.target.value)}}),Object(h.jsx)("input",{type:"text",value:x,onChange:function(e){return v(e.target.value)}}),Object(h.jsx)("button",{onClick:g,children:"Verify OTP"})]}),Object(h.jsx)("button",{className:"loginRegisterButton",onClick:function(){r.push("/register")},children:s?Object(h.jsx)(Y.a,{color:"white",size:"20px"}):"Create a New Account"})]})]})})}n(129);function $(e){var t=e.token,n="http://localhost:8800/images/",s=Object(c.useState)({}),a=Object(o.a)(s,2),r=a[0],i=a[1],l=Object(F.h)().username,u=_.BASE_URL;return Object(c.useEffect)((function(){(function(){var e=Object(S.a)(w.a.mark((function e(){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get("".concat(u,"/users?username=").concat(l),{headers:{Authorization:"Bearer ".concat(t)}});case 2:n=e.sent,i(n.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[l,t]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(E,{}),Object(h.jsxs)("div",{className:"profile",children:[Object(h.jsx)(T,{}),Object(h.jsxs)("div",{className:"profileRight",children:[Object(h.jsxs)("div",{className:"profileRightTop",children:[Object(h.jsxs)("div",{className:"profileCover",children:[Object(h.jsx)("img",{className:"profileCoverImg",src:r.coverPicture?n+r.coverPicture:n+"person/noCover.png",alt:""}),Object(h.jsx)("img",{className:"profileUserImg",src:r.profilePicture?n+r.profilePicture:n+"person/noAvatar.png",alt:""})]}),Object(h.jsxs)("div",{className:"profileInfo",children:[Object(h.jsx)("h4",{className:"profileInfoName",children:r.username}),Object(h.jsx)("span",{className:"profileInfoDesc",children:r.desc})]})]}),Object(h.jsxs)("div",{className:"profileRightBottom",children:[Object(h.jsx)(K,{username:l}),Object(h.jsx)(z,{user:r})]})]})]})]})}n(130);function ee(){var e=Object(c.useRef)(),t=Object(c.useRef)(),n=Object(c.useRef)(),s=Object(c.useRef)(),a=Object(F.g)(),r=_.BASE_URL,o=function(){var c=Object(S.a)(w.a.mark((function c(o){var i;return w.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(o.preventDefault(),s.current.value===n.current.value){c.next=5;break}s.current.setCustomValidity("Passwords don't match!"),c.next=16;break;case 5:return i={username:e.current.value,email:t.current.value,password:n.current.value},c.prev=6,console.log("inside"),c.next=10,y.a.post("".concat(r,"/auth/register"),i);case 10:a.push("/login"),c.next=16;break;case 13:c.prev=13,c.t0=c.catch(6),console.log(c.t0);case 16:case"end":return c.stop()}}),c,null,[[6,13]])})));return function(e){return c.apply(this,arguments)}}();return Object(h.jsx)("div",{className:"login",children:Object(h.jsxs)("div",{className:"loginWrapper",children:[Object(h.jsxs)("div",{className:"loginLeft",children:[Object(h.jsx)("h3",{className:"loginLogo",children:"Anything"}),Object(h.jsx)("span",{className:"loginDesc",children:"Connect and Share anything with friends and the world around you on Anything App."})]}),Object(h.jsxs)("div",{className:"loginRight",children:[Object(h.jsxs)("form",{className:"loginBox",onSubmit:o,children:[Object(h.jsx)("input",{placeholder:"Username",required:!0,ref:e,className:"loginInput"}),Object(h.jsx)("input",{placeholder:"Email",required:!0,ref:t,className:"loginInput",type:"email"}),Object(h.jsx)("input",{placeholder:"Password",required:!0,ref:n,className:"loginInput",type:"password",minLength:"6"}),Object(h.jsx)("input",{placeholder:"Password Again",required:!0,ref:s,className:"loginInput",type:"password"}),Object(h.jsx)("button",{className:"loginButton",type:"submit",children:"Sign Up"})]}),Object(h.jsx)("button",{className:"loginRegisterButton",onClick:function(){console.log("Button clicked!"),a.push("/login")},children:"Log into Account"})]})]})})}n(131),n(132);function te(e){var t=e.conversation,n=e.currentUser,s=Object(c.useState)(null),a=Object(o.a)(s,2),r=a[0],i=a[1],l="http://localhost:8800/images/",u=_.BASE_URL;return Object(c.useEffect)((function(){var e=t.members.find((function(e){return e!==n._id}));(function(){var t=Object(S.a)(w.a.mark((function t(){var n;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,y()("".concat(u,"/users?userId=")+e);case 3:n=t.sent,i(n.data),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}})()()}),[n,t]),Object(h.jsxs)("div",{className:"conversation",children:[Object(h.jsx)("img",{className:"conversationImg",src:(null===r||void 0===r?void 0:r.profilePicture)?l+r.profilePicture:l+"person/noAvatar.png",alt:""}),Object(h.jsx)("span",{className:"conversationName",children:null===r||void 0===r?void 0:r.username})]})}n(133);function ne(e){var t=e.message,n=e.own;return Object(h.jsxs)("div",{className:n?"message own":"message",children:[Object(h.jsxs)("div",{className:"messageTop",children:[Object(h.jsx)("img",{className:"messageImg",src:"https://images.pexels.com/photos/3686769/pexels-photo-3686769.jpeg?auto=compress&cs=tinysrgb&dpr=2&w=500",alt:""}),Object(h.jsx)("p",{className:"messageText",children:t.text})]}),Object(h.jsx)("div",{className:"messageBottom",children:Object(U.a)(t.createdAt)})]})}n(134);function ce(e){var t=e.onlineUsers,n=e.currentId,s=e.setCurrentChat,a=Object(c.useState)([]),r=Object(o.a)(a,2),i=r[0],l=r[1],u=Object(c.useState)([]),j=Object(o.a)(u,2),d=j[0],p=j[1],b="http://localhost:8800/images/",O=_.BASE_URL;Object(c.useEffect)((function(){(function(){var e=Object(S.a)(w.a.mark((function e(){var t;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get("".concat(O,"/users/friends/")+n);case 2:t=e.sent,l(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[n]),Object(c.useEffect)((function(){p(i.filter((function(e){return t.includes(e._id)})))}),[i,t]);var f=function(){var e=Object(S.a)(w.a.mark((function e(t){var c;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.a.get("".concat(O,"/conversations/find/").concat(n,"/").concat(t._id));case 3:c=e.sent,s(c.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsx)("div",{className:"chatOnline",children:d.map((function(e){return Object(h.jsxs)("div",{className:"chatOnlineFriend",onClick:function(){return f(e)},children:[Object(h.jsxs)("div",{className:"chatOnlineImgContainer",children:[Object(h.jsx)("img",{className:"chatOnlineImg",src:(null===e||void 0===e?void 0:e.profilePicture)?b+e.profilePicture:b+"person/noAvatar.png",alt:""}),Object(h.jsx)("div",{className:"chatOnlineBadge"})]}),Object(h.jsx)("span",{className:"chatOnlineName",children:null===e||void 0===e?void 0:e.username})]})}))})}var se=n(85);function ae(){var e=Object(c.useState)([]),t=Object(o.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)(null),r=Object(o.a)(a,2),i=r[0],l=r[1],u=Object(c.useState)([]),j=Object(o.a)(u,2),d=j[0],b=j[1],O=Object(c.useState)(""),f=Object(o.a)(O,2),v=f[0],g=f[1],N=Object(c.useState)(null),k=Object(o.a)(N,2),I=k[0],C=k[1],L=Object(c.useState)([]),A=Object(o.a)(L,2),R=A[0],P=A[1],T=Object(c.useRef)(),B=Object(c.useContext)(m).user,U=Object(c.useRef)(),F=Object(c.useContext)(x).passobject,D=_.BASE_URL,W=_.SOCKET_URL;Object(c.useEffect)((function(){T.current=Object(se.io)("ws://".concat(W,":8900")),T.current.on("getMessage",(function(e){C({sender:e.senderId,text:e.text,createdAt:Date.now()})}))}),[]),Object(c.useEffect)((function(){I&&(null===i||void 0===i?void 0:i.members.includes(I.sender))&&b((function(e){return[].concat(Object(p.a)(e),[I])}))}),[I,i]),Object(c.useEffect)((function(){T.current.emit("addUser",B._id),T.current.on("getUsers",(function(e){P(B.followings.filter((function(t){return e.some((function(e){return e.userId===t}))})))}))}),[B]),Object(c.useEffect)((function(){(function(){var e=Object(S.a)(w.a.mark((function e(){var t;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.a.get("".concat(D,"/conversations/")+B._id);case 3:t=e.sent,console.log("convs",t.data),s(t.data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}})()()}),[B._id]),Object(c.useEffect)((function(){(function(){var e=Object(S.a)(w.a.mark((function e(){var t;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.a.get("".concat(D,"/messages/")+(null===i||void 0===i?void 0:i._id));case 3:t=e.sent,b(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[i]),Object(c.useEffect)((function(){(function(){var e=Object(S.a)(w.a.mark((function e(){var t;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("passobject",F),e.next=4,y.a.get("".concat(D,"/messages/")+F._id);case 4:t=e.sent,b(t.data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}})()(),l(F)}),[F]);var M=function(){var e=Object(S.a)(w.a.mark((function e(t){var n,c,s;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n={sender:B._id,text:v,conversationId:i._id},c=i.members.find((function(e){return e!==B._id})),T.current.emit("sendMessage",{senderId:B._id,receiverId:c,text:v}),e.prev=4,e.next=7,y.a.post("".concat(D,"/messages"),n);case 7:s=e.sent,b([].concat(Object(p.a)(d),[s.data])),g(""),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){var e;null===(e=U.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[d]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(E,{}),Object(h.jsxs)("div",{className:"messenger",children:[Object(h.jsx)("div",{className:"chatMenu",children:Object(h.jsxs)("div",{className:"chatMenuWrapper",children:[Object(h.jsx)("input",{placeholder:"Search for friends",className:"chatMenuInput"}),n.map((function(e){return Object(h.jsx)("div",{onClick:function(){l(e),console.log("currchat",e)},children:Object(h.jsx)(te,{conversation:e,currentUser:B})})}))]})}),Object(h.jsx)("div",{className:"chatBox",children:Object(h.jsx)("div",{className:"chatBoxWrapper",children:i?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("div",{className:"chatBoxTop",children:d.map((function(e){return Object(h.jsx)("div",{ref:U,children:Object(h.jsx)(ne,{message:e,own:e.sender===B._id})})}))}),Object(h.jsxs)("div",{className:"chatBoxBottom",children:[Object(h.jsx)("textarea",{className:"chatMessageInput",placeholder:"write something...",onChange:function(e){return g(e.target.value)},value:v}),Object(h.jsx)("button",{className:"chatSubmitButton",onClick:M,children:"Send"})]})]}):Object(h.jsx)("span",{className:"noConversationText",children:"Open a conversation to start a chat."})})}),Object(h.jsx)("div",{className:"chatOnline",children:Object(h.jsx)("div",{className:"chatOnlineWrapper",children:Object(h.jsx)(ce,{onlineUsers:R,currentId:B._id,setCurrentChat:l})})})]})]})}var re=function(){var e=Object(c.useContext)(m),t=e.user,n=e.token;return Object(h.jsx)(d.a,{children:Object(h.jsxs)(F.d,{children:[Object(h.jsx)(F.b,{exact:!0,path:"/",children:t?Object(h.jsx)(V,{}):Object(h.jsx)(ee,{})}),Object(h.jsx)(F.b,{path:"/login",children:t?Object(h.jsx)(F.a,{to:"/"}):Object(h.jsx)(Z,{})}),Object(h.jsx)(F.b,{path:"/register",children:t?Object(h.jsx)(F.a,{to:"/"}):Object(h.jsx)(ee,{})}),Object(h.jsx)(F.b,{path:"/messenger",children:t?Object(h.jsx)(ae,{}):Object(h.jsx)(F.a,{to:"/"})}),Object(h.jsx)(F.b,{path:"/MyMap",children:t?Object(h.jsx)(A,{}):Object(h.jsx)(F.a,{to:"/"})}),Object(h.jsx)(F.b,{path:"/profile/:username",children:Object(h.jsx)($,{token:n})})]})})};r.a.render(Object(h.jsx)(s.a.StrictMode,{children:Object(h.jsx)(v,{children:Object(h.jsx)(re,{})})}),document.getElementById("root"))},92:function(e,t,n){},96:function(e,t,n){}},[[168,1,2]]]);
//# sourceMappingURL=main.ccb3c99e.chunk.js.map